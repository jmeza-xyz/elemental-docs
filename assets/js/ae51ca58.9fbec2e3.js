"use strict";(self.webpackChunkelemental_docs=self.webpackChunkelemental_docs||[]).push([[7640],{18684:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var t=i(74848),r=i(28453);const a={sidebar_label:"Building raw disk images for Raspberry Pi",title:""},s=void 0,o={id:"raspi-disk",title:"",description:"How to build raw disk images for Raspberry Pi",source:"@site/versioned_docs/version-1.6/raspi-disk.md",sourceDirName:".",slug:"/raspi-disk",permalink:"/raspi-disk",draft:!1,unlisted:!1,tags:[],version:"1.6",frontMatter:{sidebar_label:"Building raw disk images for Raspberry Pi",title:""},sidebar:"docs",previous:{title:"Air-Gapped Installation",permalink:"/airgap"},next:{title:"Trusted Platform Module (TPM)",permalink:"/tpm"}},l={},d=[{value:"How to build raw disk images for Raspberry Pi",id:"how-to-build-raw-disk-images-for-raspberry-pi",level:3},{value:"Starting the machine",id:"starting-the-machine",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components},{Head:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i,{children:(0,t.jsx)("link",{rel:"canonical",href:"https://elemental.docs.rancher.com/raspi-disk"})}),"\n",(0,t.jsx)(n.h3,{id:"how-to-build-raw-disk-images-for-raspberry-pi",children:"How to build raw disk images for Raspberry Pi"}),"\n",(0,t.jsx)(n.p,{children:"This guide will show how we can build a raw disk image that can be written to an SD-card and booted without any other installation media."}),"\n",(0,t.jsxs)(n.admonition,{type:"caution",children:[(0,t.jsx)(n.p,{children:"Any data on the SD-card will be erased, please only use a SD-card without anything important on it."}),(0,t.jsxs)(n.p,{children:["The SD-card must be reasonably large (32 GB or more) and ",(0,t.jsx)(n.strong,{children:"fast"})," (!!)."]})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="SeedImage resource" showLineNumbers',children:"apiVersion: elemental.cattle.io/v1beta1\nkind: SeedImage\nmetadata:\n  name: fire-img\n  namespace: fleet-default\nspec:\n  type: raw\n  baseImage: registry.opensuse.org/isv/rancher/elemental/staging/containers/suse/sl-micro/6.0/baremetal-os-container:latest\n  targetPlatform: linux/arm64\n  registrationRef:\n    apiVersion: elemental.cattle.io/v1beta1\n    kind: MachineRegistration\n    name: fire-nodes\n    namespace: fleet-default\n"})}),"\n",(0,t.jsx)(n.p,{children:"Check the logs for the build pod using:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"kubectl logs -n fleet-default fire-img -f -c build\n"})}),"\n",(0,t.jsx)(n.p,{children:"When the build is finished we can download the image file using wget:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'wget --no-check-certificate $(kubectl get seedimage -n fleet-default fire-img -o jsonpath="{.status.downloadURL}") -O sle-micro.arm64.raw\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Now we can write the ",(0,t.jsx)(n.code,{children:".raw"})," image to the SD-card. This can be done with ",(0,t.jsx)(n.code,{children:"dd"})," on the Linux command line if you're comfortable with this command.\n",(0,t.jsx)(n.a,{href:"https://www.opensuse.org",children:"openSUSE"})," has nice instructions on how to write an image to a storage medium for ",(0,t.jsx)(n.a,{href:"https://en.opensuse.org/SDB:Live_USB_stick",children:"Linux"}),",\n",(0,t.jsx)(n.a,{href:"https://en.opensuse.org/SDB:Create_a_Live_USB_stick_using_Windows",children:"Windows"}),", and ",(0,t.jsx)(n.a,{href:"https://en.opensuse.org/SDB:Create_a_Live_USB_stick_using_macOS",children:"OS X"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"starting-the-machine",children:"Starting the machine"}),"\n",(0,t.jsx)(n.p,{children:"The raw disk image will only include the EFI partition, OEM partition and\nrecovery partition. On first boot the system will boot into the recovery system\nto expand and add missing partitions. After expansion it will register with\nrancher and reboot."}),"\n",(0,t.jsxs)(n.p,{children:["If an error occurs during registration phase the journal can be found using\n",(0,t.jsx)(n.code,{children:"journalctl -u elemental-register-reset"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var t=i(96540);const r={},a=t.createContext(r);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);